jQuery(document).ready(function(o){"use strict";var e=o('.ywccl[data-type="colorpicker"]'),t=o('.ywccl[data-type="image"]'),e=(e.each(function(){o(this).wpColorPicker(),o(this).hasClass("hidden_empty")&&!o(this).val()&&o(this).closest(".wp-picker-container").hide()}),t.each(function(){var e=o("<input type='button' name='' id='term_value_button' class='button' value='Upload' />");e.insertAfter(this),e.on("click",function(e){e.preventDefault();var t,i=o(this).attr("id").replace("_button","");t||(e=[new wp.media.controller.Library({library:wp.media.query(),multiple:!1,title:"Choose Image",priority:20,filterable:"uploaded"})],(t=wp.media.frames.downloadable_file=wp.media({title:"Choose Image",library:{type:""},button:{text:"Choose Image"},multiple:!1,states:e})).on("select",function(){var e=t.state().get("selection").first().toJSON();o("#"+i).val(e.url)})),t.open()})}),o(".product_page_product_attributes .woocommerce form")),n=("undefined"!=typeof yith_wccl_admin&&yith_wccl_admin.html&&e.find(".form-field").last().after(yith_wccl_admin.html),o(".ywccl_add_color_icon").off("click").on("click",function(){var e=o(this),t=e.data("content"),i=o(this).nextAll(".wp-picker-container"),a=i.find(".wp-picker-clear");e.data("content",e.html()),e.html(t),a.click(),i.toggle()}),function(e){var t=e.find(".yith_wccl_variation_gallery_values"),e=e.find("li.image:not('.add')"),i=[];o.each(e,function(){i.push(o(this).data("value"))}),t.attr("value",i.join(",")).change()});o(document).on("woocommerce_variations_loaded woocommerce_variations_added",function(){o(".woocommerce_variation:not('.initialized')").each(function(e,t){var i=o(t).find(".yith-wccl-variation-gallery-wrapper"),t=o(t).find(".form-row-full.options").first();i.insertBefore(t),i.find(".yith-wccl-variation-gallery-images").sortable({items:"li.image:not('.add')",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"yith-wccl-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style")},update:function(){n(i)}}),o(this).addClass("initialized")})}),o(document).on("click",".yith-wccl-variation-gallery-images .remove",function(e){e.preventDefault();e=o(this).closest(".yith-wccl-variation-gallery-wrapper");o(this).closest(".image").remove(),n(e)}),o(document).on("click",".add-variation-gallery-image",function(e){var t,i,a;e.preventDefault(),"undefined"!=typeof wp&&(e=o(this),t=e.closest(".yith-wccl-variation-gallery-wrapper"),i=t.find(".yith-wccl-variation-gallery-images"),e.attr("data-index"),(a=wp.media({title:woocommerce_admin_meta_boxes_variations.i18n_choose_image,button:{text:woocommerce_admin_meta_boxes_variations.i18n_set_image},library:{type:"image"},multiple:!0})).on("select",function(){var e=a.state().get("selection").toJSON().map(function(e){if("image"!==e.type||i.find('[data-value="'+e.id+'"]').length)return"";var t=e.id,e=(e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail:e).url;return wp.template("yith-wccl-variation-gallery-image")({id:t,url:e})}).join("");i.find(".image.add").before(e),n(t)}),a.open())})});